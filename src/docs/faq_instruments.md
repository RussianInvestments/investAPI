### Что такое FIGI инструмента?<a id="1.1"></a>

**FIGI** (Financial Instrument Global Identifier) — глобальный идентификатор
финансового инструмента. Представляет собой 12-символьный код из латинских букв и цифр и
определяется как идентификатор ценной бумаги на торговой площадке (бирже), которая
является некоторым «источником цен».

Учитывайте, что не у всех инструментов, которые доступны в Т-Инвестициях, есть общепринятый
FIGI — поэтому уникальность инструментов с другими источниками не гарантируется. 

Узнать актуальный FIGI-идентификатор инструмента можно через методы [сервиса инструментов](/investAPI/instruments/).

>**Важно** <br>
>Сейчас основной идентификатор внутри Т-Инвестиций — UID. Он позволяет избежать возможной путаницы.

### Как найти FIGI инструмента по его названию, тикеру или ISIN?<a id="1.2"></a>

Через методы поиска инструментов по идентификатору — [BondBy](/investAPI/instruments#bondby), 
[CurrencyBy](/investAPI/instruments#currencyby), [EtfBy](/investAPI/instruments#etfby), 
[FutureBy](/instruments#futureby), [ShareBy](/investAPI/instruments#shareby). Они позволяют получить 
информацию об инструменте, зная его FIGI или связку ticker + class_code. 

Если вы не знаете эти идентификаторы, получить полный список инструментов определённого типа можно через методы запроса
списков инструментов — [Bonds](/investAPI/instruments#bonds), [Currencies](/investAPI/instruments#currencies), [Etfs](/investAPI/instruments#etfs), [Futures](/instruments#futures), [Shares](/investAPI/instruments#shares). Выполните поиск по известным параметрам самостоятельно — это можно сделать в коде робота или через любый доступный gRPC-клиент,
например, Kreya. [Инструкция по настройке Kreya](/investAPI/grpc#kreya).

### Что такое `class_code` и где его найти?<a id="1.3"></a>

`class_code` — это технический параметр «Режим торгов». Используется для обозначения секции биржи, на
которой торгуется инструмент. 

Чтобы его узнать, получите детали по инструменту через методы [сервиса инструментов](/investAPI/instruments/).

### Как понять, что бумага доступна для торговли через T-Invest API?<a id="1.4"></a>

Чтобы получить все доступные для торговли инструменты определённого типа, передайте параметр `instrument_status` = `INSTRUMENT_STATUS_BASE` в нужном методе: 

* [Bonds](/investAPI/instruments#bonds).
* [Currencies](/investAPI/instruments#currencies).
* [Etfs](/investAPI/instruments#etfs).
* [Futures](/instruments#futures).
* [Shares](/investAPI/instruments#shares).

Если вам не нужно получать полный список инструментов, используйте параметр `api_trade_available_flag` из ответа методов получения инструмента по его идентификатору — [BondBy](/investAPI/instruments#bondby), [CurrencyBy](/investAPI/instruments#currencyby), [EtfBy](/investAPI/instruments#etfby), [FutureBy](/instruments#futureby), [ShareBy](/investAPI/instruments#shareby). Он отвечает за доступность инструмента для торгов через T-Invest API.

Также учитывайте расписание работы бирж и торговый статус инструмента. [Подробнее](/investAPI/faq_trading_status/).

### Что такое накопленный купонный доход облигации и как его узнать? <a id="1.5"></a>

**Купон, или купонный доход** — это процентные выплаты держателям облигаций со стороны эмитента, то есть
компании или госоргана, выпустивших этот тип ценных бумаг.

Даты выплат процентов по облигациям и размер купона известны заранее. Размер купона задаётся в процентах от
номинала — то есть от цены облигации при её выпуске. Величина купона может быть фиксированной или плавающей —
привязанной к инфляции, ключевой ставке Центробанка России или другим ориентирам. Иногда у облигации
может не быть купона. [Купонный доход по облигациям](https://www.tbank.ru/invest/account/help/get-profit/coupon-yield).

Получить календарь купонных выплат можно через метод [GetAccruedInterests](/investAPI/instruments#getaccruedinterests).

### Как узнать стоимость шага цены (min_price_increment_amount) фьючерса? <a id="1.6"></a>

Этот параметр может изменяться довольно часто в течение дня, поэтому для его получения есть 
отдельный метод сервиса инструментов — [GetFuturesMargin](/investAPI/instruments#getfuturesmargin).

### Как узнать, на какой бирже исполняются расчёты по инструменту? <a id="1.7"></a>

В T-Invest API есть параметр [real_exchange](/investAPI/instruments/#realexchange) — он передаётся для определения биржи, на которой исполняются расчёты по финансовому инструменту.

Список методов:

* [GetInstrumentBy](/investAPI/instruments/#getinstrumentby) — получить основную информацию об инструменте.
* [BondBy](/investAPI/instruments/#bondby) — получить облигацию по её идентификатору.
* [Bonds](/investAPI/instruments/#bonds) — получить список облигаций.
* [ShareBy](/investAPI/instruments/#shareby) — получить акцию по её идентификатору.
* [Shares](/investAPI/instruments/#shares) — получить список акций.
* [EtfBy](/investAPI/instruments/#etfby) — получить инвестиционный фонд по его идентификатору.
* [Etfs](/investAPI/instruments/#etfs) — получить список инвестиционных фондов.
* [FutureBy](/investAPI/instruments/#futureby) — получить фьючерс по его идентификатору.
* [Futures](/investAPI/instruments/#futures) — получить список фьючерсов.
* [CurrencyBy](/investAPI/instruments/#currencyby) — получить валюту по её идентификатору.
* [Currencies](/investAPI/instruments/#currencies) — получить список валют.
* [OptionBy](/investAPI/instruments/#optionby) — получить опцион по его идентификатору.
* [Options](/investAPI/instruments/#options) — получить опционы.

### Как найти базовый актив фьючерса? <a id="1.8"></a>

Чтобы найти базовый актив фьючерса, можно использовать метод [FindInstrument](/investAPI/instruments/#findinstrument) — для этого в **query** передайте значение параметра `basic_asset_position_uid`, которое возвращается в методах [GetFutureBy](/investAPI/instruments/#futureby) и [GetFutures](/investAPI/instruments/#futures).

### Как получить и изменить список избранных инструментов?

<ul>
<li><p>Список избранных инструментов можно получить через метод <a href="/investAPI/instruments#getfavorites">GetFavorites</a> — в ответе возвращаются инструменты, которые робот добавил в избранное через метод <a href="/investAPI/instruments#editfavorites">EditFavorites</a>.</p>
</li>
<li><p>Добавить или удалить инструменты из списка избранных можно через метод <a href="/investAPI/instruments#editfavorites">EditFavorites</a>. С помощью него можно автоматизировать выделение наиболее интересных инструментов через редактирование списка избранных инструментов.</p>
<p> Ограничение на использование метода — 100 инструментов. Если вы передадите больше 100 инструментов, вернётся ошибка с кодом <code>30091</code> и сообщением <code>quantity of instruments can&#39;t be more than 100</code>.</p>
</li>
</ul>

>**Важно**
><p>Если вы хотите добавить валюту в список избранных инструментов, это нужно делать через валюту с лотностью 1. Инструменты валюты с разной лотностью имеют разные значения идентификаторов.</p>
><p>У позиции (валюты) есть разные инструменты, которыми можно торговать. Например, у доллара это могут быть инструменты с лотностью в 1 доллар или 1000 долларов.</p>
><p>Примеры идентификаторов:</p>
><ul>
><li>FIGI доллара США с лотностью <code>1000</code> — <code>TCS0013HGFT4</code>, а FIGI доллара США с лотностью <code>1</code> — <code>USD000UTSTOM</code>.</li>
><li>FIGI евро с лотностью <code>1000</code> — <code>BBG0013HJJ31</code>, а FIGI доллара США с лотностью <code>1</code> — <code>EUR000UTSTOM</code>.</li>
></ul>

### Как отличить инструмент доступный для ИИС? <a id="1.9"></a>

В методах для получения информации об инструментах есть флаг `for_iis_flag` — он принимает булевое значение в зависимости от доступности инструмента для ИИС.

### Как получить информацию об активах?

<p>В T-Invest API есть два метода для получения активов:</p>
<ol>
<li><p><a href="/investAPI/instruments/#getassets">getAssets</a> — получить список всех активов. Метод работает для всех инструментов, кроме срочных: опционов и фьючерсов. Возвращает краткую информацию об активе: </p>
<ul>
<li>Идентификатор.</li>
<li>Тип актива.</li>
<li>Название актива.</li>
<li>Массив инструментов актива.</li>
</ul>
</li>
<li><p><a href="/investAPI/instruments/#getassetby">getAssetBy</a> — найти актив по его идентификатору.
Метод возвращает более подробную информацию о запрошенном активе. Набор данных отличается в зависимости от типа актива.</p>
</li>
</ol>

### Как получить информацию об брендах?<a id="1.10"></a>

В T-Invest API есть два метода для получения брендов:

1. [Brands](/investAPI/instruments/#getbrands) — получить список всех брендов.

2. [BrandBy](/investAPI/instruments/#getbrandby) — найти бренд по его идентификатору.

### Как по позиции найти инструмент? <a id="1.11"></a>

Для поиска инструмента по идентификатору позиции (`position_uid`) есть тип идентификатора инструмента — `INSTRUMENT_ID_TYPE_POSITION_UID`.

Использовать `id_type = INSTRUMENT_ID_TYPE_POSITION_UID` можно в методах:

* [InstrumentBy](/investAPI/instruments/#getinstrumentby) — получить основную информацию об инструменте.
* [BondBy](/investAPI/instruments/#bondby) — получить облигацию по её идентификатору.
* [ShareBy](/investAPI/instruments/#shareby) — получить акцию по её идентификатору.
* [EtfBy](/investAPI/instruments/#etfby) — получить инвестиционный фонд по его идентификатору.
* [FutureBy](/investAPI/instruments/#futureby) — получить фьючерс по его идентификатору.
* [OptionBy](/investAPI/instruments/#optionby) — получить опцион по его идентификатору.
* [CurrencyBy](/investAPI/instruments/#currencyby) — получить валюту по её идентификатору.

### Ставки риска и их коэфффиценты <a id="1.12"></a>

Чтобы лучше понять тему, вы можете ознакомиться с материалами, указанными в ссылках. Здесь же мы приведем лишь краткое определения и раскроем суть параметров.

**Ставка риска** — это показатель, который брокер использует для расчёта суммы, которую вам нужно иметь на счёте, чтобы открыть или поддерживать непокрытую позицию. Чем ниже ставка риска, тем крупнее может быть непокрытая позиция — то есть брокер будет готов одолжить больше активов. И наоборот: с высокой ставкой риска размер кредитного плеча в сделке будет небольшим или его не будет вообще. [Подробнее о ставках риска](https://www.tbank.ru/invest/help/brokerage/account/margin/about/#q5).

**Уровни риска**  —  Клиенты российских брокеров — физические лица делятся на несколько категорий. Каждой категории соответствует свое кредитное плечо. В методах сервиса инструментов в параметрах `dshort_client` и `dlong_client` передается ставка риска уже с учетом категории.

**Кредитное плечо** — это беспроцентный заём, который брокер предоставляет инвестору для совершения сделок на более крупные суммы. Это соотношение между собственными средствами трейдера и заёмными деньгами, которые предоставляет брокер или дилинговый центр на специальных условиях.

**Начальная маржа** — это стоимость всех ликвидных активов и фьючерсов в портфеле инвестора, приведённая к рублям по биржевому курсу и умноженная на ставки риска этих активов.

**Скорректированная маржа** — показатель, аналогичный начальной марже, но учитывающий выставленные вами лимитные заявки на увеличение позиции (на любую покупку или на продажу в шорт).

**Минимальная маржа** — это половина от начальной или скорректированной маржи портфеля.

**Лонг, или длинная позиция** — это сделка по покупке актива, когда инвестор ожидает роста его цены. Если инвесторы хотят заработать на растущем рынке, они торгуют в лонг. 

**Шорт, или короткая позиция** — это сделка по продаже полученного в долг актива с целью выкупа его дешевле через некоторое время и заработка на разнице цен. Когда инвесторы хотят получить прибыль за счёт снижения стоимости актива, они торгуют в шорт — также это называется «игрой на понижение» или «непокрытой продажей». [Подробнее о торговле в шорт](https://www.tbank.ru/invest/help/brokerage/account/margin/short/).

<p>В методах сервиса инструментов есть параметры, связанные со ставками риска:</p>
<ul>
<li><p><code>klong</code> — коэффициент ставки риска длинной позиции по клиенту:</p>
<ul>
<li>2 — клиент со стандартным уровнем риска (КСУР);</li>
<li>1 — клиент с повышенным уровнем риска (КПУР).</li>
</ul>
</li>
<li><p><code>kshort</code> — коэффициент ставки риска короткой позиции по клиенту:</p>
<ul>
<li>2 – клиент со стандартным уровнем риска (КСУР);</li>
<li>1 – клиент с повышенным уровнем риска (КПУР).</li>
</ul>
</li>
<li><p><code>dlong</code> — ставка риска начальной маржи для КСУР лонг.  </p>
</li>
<li><code>dshort</code> — ставка риска начальной маржи для КСУР шорт.  </li>
<li><code>dlong_min</code> — ставка риска начальной маржи для КПУР лонг.  </li>
<li><code>dshort_min</code> — ставка риска начальной маржи для КПУР шорт.  </li>
</ul>

Коэффициенты маржинальной торговли есть только у инструментов из [перечня ликвидного имущества](https://www.tbank.ru/invest/margin/equities/).

### Как узнать, торгуется ли инструмент на выходных? <a id="1.13"></a>

В методах инстурментов есть флаг `weekend_flag`:

- `true` — инструмент торгуется;
- `false` — инструмент не торгуется.

### Какие заявки можно выставить по опционам? <a id="1.14"></a>

Сейчас торговля опционами через API недоступна. 

### Что такое `liquidity_flag`? <a id="1.15"></a>

**Ликвидность** — это способность быстро продать актив по рыночной цене, то есть без скидок. Чем быстрее это можно сделать, тем выше ликвидность актива. 

   Ликвидность инструмента на фондовом рынке оценивают по количеству совершаемых сделок — то есть по объёму торгов — и величине спреда. 

**Спред** — это разница между максимальными ценами заявок на покупку и минимальными ценами заявок на продажу. Чем больше сделок и меньше разница, тем выше ликвидность.

Раз в полчаса брокер рассчитывает ликвидность по всем финансовым инструментам: 

- Для облигаций —  `liquidity` = `((Среднедневная цена * current_nominal)/100) * (Дневной объём торгов)`.
- В остальных случаях — `liquidity` = `(Среднедневная цена) * (Дневной объём торгов)`.

На основе значения `liqudity` для разных типов финансовых инструментов устанавливается значение флага `liquidity_flag`:

- `true` — инструмент считается ликвидным;
- `false` — инструмент не считается ликвидным.

### Корпоративные действия и изменение идентификатора инструмента <a id="1.16"></a>

**Корпоративные действия** — это события, связанные с ценной бумагой: например, сплит, консолидация, конвертация и другие.  Каждое корпоративное действие индивидуально и имеет свои условия.

Некоторые корпоративные действия приводят к изменению инструмента и его параметров на бирже — новый тикер, изменение лотности, шага цены, стоимости. После таких событий:

* создаётся новый инструмент с новыми идентификаторами — FIGI, UID;
* позиция переносится на новый инструмент;
* операции начинают проводиться по созданному инструменту;
* старый инструмент помечается удалённым и становится недоступен в API;
* исторические данные по инструменту, который существовал до корпоративного действия, больше недоступны.

### Как скачать логотип компании? <a id="1.17"></a>

В методах [GetBondBy](/investAPI/instruments/#bondby), [GetBonds](/investAPI/instruments/#bonds), [GetShareBy](/investAPI/instruments/#shareby), [GetShares](/investAPI/instruments/#shares),
[GetEtfBy](/investAPI/instruments/#etfby), [GetEtfs](/investAPI/instruments/#etfs), [GetFutureBy](/investAPI/instruments/#futureby), [GetFutures](/investAPI/instruments/#futures),
[GetCurrencyBy](/investAPI/instruments/#currencyby), [GetCurrencies](/investAPI/instruments/#currencies) есть информация о бренде, в том числе логотип компании.

Чтобы скачать логотип, сформируйте запрос вида `https://invest-brands.cdn-tinkoff.ru/<logoName<size>.png>`, где `<logoName<size>.png>` — логотип компании с размерами в точках. Доступные размеры — 160x, 320x, 640x.

**Пример** 

Логотип компании TCS Group — `US87238U20333.png`. Запрос будет одним из следующих:

| Размер логотипа |                                                       Запрос                                                             |
|:----------------|:-------------------------------------------------------------------------------------------------------------------------|
|       160x     | [https://invest-brands.cdn-tinkoff.ru/US87238U20333x160.png](https://invest-brands.cdn-tinkoff.ru/US87238U20333x160.png) |
|       320x      | [https://invest-brands.cdn-tinkoff.ru/US87238U20333x320.png](https://invest-brands.cdn-tinkoff.ru/US87238U20333x320.png) |
|       640x      | [https://invest-brands.cdn-tinkoff.ru/US87238U20333x640.png](https://invest-brands.cdn-tinkoff.ru/US87238U20333x640.png) |