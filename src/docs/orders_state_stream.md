## О стриме

Стрим-соединение T-Invest API для получения изменений состояния заявок.

Используется для получения событий по заявкам с момента выставления до момента исполнения или отмены. 
Переход заявки от одного статуса в другой формирует событие в стриме.

[Статусная модель заявок](/investAPI/head-orders/#_2) 

В статусе `PARTYALLY_FILL` события формируются по мере исполнения заявки.

## Особенности работы

В методе передаются все заявки по счёту из подписки, но связать заявку в стриме с поручением, которое отправлено через метод [PostOrder](/investAPI/orders/#postorder), можно не всегда.

Заявки, которые транслируются в стриме, можно идентифицировать по `order_request_id` — [ключу идемпотентности](/investAPI/head-orders/#_6). Он передаётся при [выставлении заявки](/investAPI/orders/#postorder).

Чтобы поддержать клиентский идентификатор в стриме [ключ идемпотентности](/investAPI/faq_orders/#order_id-postorder_1) должен быть передан в формате UID.


### Ключ идемпотентности в формате UID

`order_request_id` в сообщениях стрима передаётся только формате UID. Если в [PostOrderRequest](/investAPI/orders/#postorderrequest) передать значение в другом формате, оно будет подменено в сообщениях стрима на сгенерированный API UID. Однозначно связать выставленное поручение не получится.

Возможные ответы стрима в зависимости от параметов, переданных в [PostOrderRequest](/investAPI/orders/#postorderrequest):

|Ключ идемпотентности| Ответы стрима|
|-|-|
|Не передан</br> Передан не в UID| В сообщениях `order_request_id`, сгенерированный API|
|Передан в UID| В сообщениях `order_request_id` из [PostOrder](/investAPI/orders/#postorder)|

## ReplaceOrder

В методе [изменения выставленной заявки](/investAPI/orders/#replaceorderrequest) пока не поддерживается новая маршрутизация. Мы доработаем это в ближайшее время.

## Сообщения стрима

### Статусы

Первое сообщение по поручению в стриме соответствует получению заявки брокером. На этом этапе ещё не определён биржевой номер заявки, в `order_id` передаётся внутренний номер.

### Состав сообщений

Некоторые параметры ответа, например, список сделок и маркер, опциональные и ориентированы на будущее развитие метода.